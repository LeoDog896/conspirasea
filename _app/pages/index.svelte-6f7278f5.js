import{S as Oe,i as We,s as Ye,e as V,k as se,c as F,a as K,m as le,d as C,b as A,g as G,J as Z,K as H,L as Ie,M as Ue,N as pe,t as he,h as ge,O as Ee,n as ve,P as qe,w as Je,Q as Ve,R as ue,E as Se,j as Fe,T as Ce}from"../chunks/index-4515c105.js";function Ke(e,t,n,o){var l,s=(l=o)==null||typeof l=="number"||typeof l=="boolean"?o:n(o),r=t.get(s);return r===void 0&&(r=e.call(this,o),t.set(s,r)),r}function Ge(e,t,n){var o=Array.prototype.slice.call(arguments,3),l=n(o),s=t.get(l);return s===void 0&&(s=e.apply(this,o),t.set(l,s)),s}function Qe(e,t){return function(n,o,l,s,r){return l.bind(o,n,s,r)}(e,this,e.length===1?Ke:Ge,t.cache.create(),t.serializer)}const je=JSON.stringify;function ae(){this.cache=Object.create(null)}ae.prototype.has=function(e){return e in this.cache},ae.prototype.get=function(e){return this.cache[e]},ae.prototype.set=function(e,t){this.cache[e]=t};var Ze={create:function(){return new ae}};const xe=(e,t={})=>{var _e,we;let{bounds:n,axis:o="both",gpuAcceleration:l=!0,applyUserSelectHack:s=!0,disabled:r=!1,ignoreMultitouch:M=!1,grid:D,position:m,cancel:v,handle:d,defaultClass:S="neodrag",defaultClassDragging:N="neodrag-dragging",defaultClassDragged:g="neodrag-dragged",defaultPosition:c={x:0,y:0},onDragStart:y,onDrag:h,onDragEnd:_}=t;const k=new Promise(requestAnimationFrame);let R,i,u=!1,f=0,p=0,E=0,L=0,x=0,$=0,{x:Q,y:j}=m?{x:(_e=m==null?void 0:m.x)!=null?_e:0,y:(we=m==null?void 0:m.y)!=null?we:0}:c;fe(Q,j,e,l);let P,B,ee,W,be="",Xe=!!m;const ce=document.body.style,I=e.classList,de=(a,X)=>{const O={offsetX:f,offsetY:p,domRect:e.getBoundingClientRect()};e.dispatchEvent(new CustomEvent(a,{detail:O})),X==null||X(O)},te=addEventListener;te("touchstart",ne,!1),te("touchend",oe,!1),te("touchmove",re,!1),te("mousedown",ne,!1),te("mouseup",oe,!1),te("mousemove",re,!1),e.style.touchAction="none";const me=()=>{let a=e.offsetWidth/B.width;return isNaN(a)&&(a=1),a};function ne(a){if(r||M&&a.type==="touchstart"&&a.touches.length>1)return;if(I.add(S),ee=function(b,T){if(!b)return T;if(b instanceof HTMLElement)return b;const w=T.querySelector(b);if(w===null)throw new Error("Selector passed for `handle` option should be child of the element on which the action is applied");return w}(d,e),W=function(b,T){if(!b)return;if(b instanceof HTMLElement)return b;const w=T.querySelector(b);if(w===null)throw new Error("Selector passed for `cancel` option should be child of the element on which the action is applied");return w}(v,e),R=/(both|x)/.test(o),i=/(both|y)/.test(o),n!==void 0&&(P=function(b,T){if(b instanceof HTMLElement)return b.getBoundingClientRect();if(typeof b=="object"){const{top:U=0,left:q=0,right:J=0,bottom:ie=0}=b;return{top:U,right:window.innerWidth-J,bottom:window.innerHeight-ie,left:q}}if(b==="parent")return T.parentNode.getBoundingClientRect();const w=document.querySelector(b);if(w===null)throw new Error("The selector provided for bound doesn't exists in the document.");return w.getBoundingClientRect()}(n,e)),B=e.getBoundingClientRect(),Ne(d)&&Ne(v)&&d===v)throw new Error("`handle` selector can't be same as `cancel` selector");if(W!=null&&W.contains(ee))throw new Error("Element being dragged can't be a child of the element on which `cancel` is applied");if(ee.contains(a.target)&&!(W!=null&&W.contains(a.target))&&(u=!0),!u)return;s&&(be=ce.userSelect,ce.userSelect="none"),de("neodrag:start",y);const{clientX:X,clientY:O}=Me(a)?a.touches[0]:a,z=me();R&&(E=X-Q/z),i&&(L=O-j/z),P&&(x=X-B.left,$=O-B.top)}function oe(){u&&(I.remove(N),I.add(g),s&&(ce.userSelect=be),de("neodrag:end",_),R&&(E=f),R&&(L=p),u=!1)}function re(a){if(!u)return;I.add(N),a.preventDefault(),B=e.getBoundingClientRect();const{clientX:X,clientY:O}=Me(a)?a.touches[0]:a;let z=X,b=O;const T=me();if(P){const w={left:P.left+x,top:P.top+$,right:P.right+x-B.width,bottom:P.bottom+$-B.height};z=De(z,w.left,w.right),b=De(b,w.top,w.bottom)}if(Array.isArray(D)){let[w,U]=D;if(isNaN(+w)||w<0)throw new Error("1st argument of `grid` must be a valid positive number");if(isNaN(+U)||U<0)throw new Error("2nd argument of `grid` must be a valid positive number");let q=z-E,J=b-L;[q,J]=$e([Math.floor(w/T),Math.floor(U/T)],q,J),z=E+q,b=L+J}R&&(f=(z-E)*T),i&&(p=(b-L)*T),Q=f,j=p,de("neodrag",h),k.then(()=>fe(f,p,e,l))}return{destroy:()=>{const a=removeEventListener;a("touchstart",ne,!1),a("touchend",oe,!1),a("touchmove",re,!1),a("mousedown",ne,!1),a("mouseup",oe,!1),a("mousemove",re,!1)},update:a=>{var O,z,b,T,w,U,q,J,ie,ye,ke;o=a.axis||"both",r=(O=a.disabled)!=null?O:!1,M=(z=a.ignoreMultitouch)!=null?z:!1,d=a.handle,n=a.bounds,v=a.cancel,s=(b=a.applyUserSelectHack)!=null?b:!0,D=a.grid,l=(T=a.gpuAcceleration)!=null?T:!0;const X=I.contains(g);I.remove(S,g),S=(w=a.defaultClass)!=null?w:"neodrag",N=(U=a.defaultClassDragging)!=null?U:"neodrag-dragging",g=(q=a.defaultClassDragged)!=null?q:"neodrag-dragged",I.add(S),X&&I.add(g),Xe&&(Q=f=(ie=(J=a.position)==null?void 0:J.x)!=null?ie:f,j=p=(ke=(ye=a.position)==null?void 0:ye.y)!=null?ke:p,k.then(()=>fe(f,p,e,l)))}}},Me=e=>{var t;return!!((t=e.touches)!=null&&t.length)},De=(e,t,n)=>Math.min(Math.max(e,t),n),Ne=e=>typeof e=="string";var Le,Pe,Be;const $e=(Te=([e,t],n,o)=>{const l=(s,r)=>Math.round(s/r)*r;return[l(n,e),l(o,t)]},Ae=(Le=Y==null?void 0:Y.cache)!=null?Le:Ze,Re=(Pe=Y==null?void 0:Y.serializer)!=null?Pe:je,((Be=Y==null?void 0:Y.strategy)!=null?Be:Qe)(Te,{cache:Ae,serializer:Re}));var Te,Y,Ae,Re;function fe(e,t,n,o){n.style.transform=o?`translate3d(${+e}px, ${+t}px, 0)`:`translate(${+e}px, ${+t}px)`}const{window:et}=Ve;function ze(e,t,n){const o=e.slice();return o[18]=t[n],o[19]=t,o[20]=n,o}function tt(e){let t,n=(e[18].content||"")+"",o;return{c(){t=V("span"),o=he(n)},l(l){t=F(l,"SPAN",{});var s=K(t);o=ge(s,n),s.forEach(C)},m(l,s){G(l,t,s),Z(t,o)},p(l,s){s&8&&n!==(n=(l[18].content||"")+"")&&Fe(o,n)},d(l){l&&C(t)}}}function nt(e){let t,n=e[19],o=e[20],l,s;function r(...d){return e[6](e[18],e[19],e[20],...d)}const M=()=>e[7](t,n,o),D=()=>e[7](null,n,o);function m(){return e[8](e[18],e[19],e[20])}function v(){e[9].call(t,e[19],e[20])}return{c(){t=V("textarea"),this.h()},l(d){t=F(d,"TEXTAREA",{class:!0,placeholder:!0}),K(t).forEach(C),this.h()},h(){A(t,"class","resize-none dark:bg-black bg-white"),A(t,"placeholder","Enter notes content...")},m(d,S){G(d,t,S),M(),Ce(t,e[18].content),l||(s=[H(t,"keydown",r),H(t,"blur",m),H(t,"input",v)],l=!0)},p(d,S){e=d,(n!==e[19]||o!==e[20])&&(D(),n=e[19],o=e[20],M()),S&8&&Ce(t,e[18].content)},d(d){d&&C(t),D(),l=!1,pe(s)}}}function He(e){let t,n,o,l=e[19],s=e[20],r,M,D;function m(_,k){return _[18].editable?nt:tt}let v=m(e),d=v(e);const S=()=>e[10](t,l,s),N=()=>e[10](null,l,s);function g(){return e[11](e[18],e[19],e[20])}function c(){return e[12](e[18],e[19],e[20])}function y(..._){return e[13](e[18],e[19],e[20],..._)}function h(){return e[14](e[18],e[19],e[20])}return{c(){t=V("div"),d.c(),n=se(),this.h()},l(_){t=F(_,"DIV",{class:!0});var k=K(t);d.l(k),n=le(k),k.forEach(C),this.h()},h(){A(t,"class",o="transition-shadow fixed max-w-md z-0 p-6 shadow-lg rounded-md "+(e[18].selected?"bg-gray-200":"bg-white")+" dark:bg-black")},m(_,k){G(_,t,k),d.m(t,null),Z(t,n),S(),M||(D=[H(t,"dblclick",g),H(t,"click",c),Ie(r=xe.call(null,t,{axis:"both",bounds:"#container",position:e[18].position,defaultClassDragging:"box-dragging"})),H(t,"neodrag",y),H(t,"neodrag:end",h)],M=!0)},p(_,k){e=_,v===(v=m(e))&&d?d.p(e,k):(d.d(1),d=v(e),d&&(d.c(),d.m(t,n))),k&8&&o!==(o="transition-shadow fixed max-w-md z-0 p-6 shadow-lg rounded-md "+(e[18].selected?"bg-gray-200":"bg-white")+" dark:bg-black")&&A(t,"class",o),(l!==e[19]||s!==e[20])&&(N(),l=e[19],s=e[20],S()),r&&Ue(r.update)&&k&8&&r.update.call(null,{axis:"both",bounds:"#container",position:e[18].position,defaultClassDragging:"box-dragging"})},d(_){_&&C(t),d.d(),N(),M=!1,pe(D)}}}function ot(e){let t,n,o,l,s,r,M,D,m,v,d,S,N=e[3],g=[];for(let c=0;c<N.length;c+=1)g[c]=He(ze(e,N,c));return{c(){t=V("div");for(let c=0;c<g.length;c+=1)g[c].c();n=se(),o=V("canvas"),l=se(),s=V("div"),r=V("button"),M=he("Save"),D=se(),m=V("button"),v=he("Load"),this.h()},l(c){t=F(c,"DIV",{id:!0,class:!0});var y=K(t);for(let R=0;R<g.length;R+=1)g[R].l(y);y.forEach(C),n=le(c),o=F(c,"CANVAS",{class:!0,width:!0,height:!0}),K(o).forEach(C),l=le(c),s=F(c,"DIV",{class:!0});var h=K(s);r=F(h,"BUTTON",{class:!0});var _=K(r);M=ge(_,"Save"),_.forEach(C),D=le(h),m=F(h,"BUTTON",{class:!0});var k=K(m);v=ge(k,"Load"),k.forEach(C),h.forEach(C),this.h()},h(){A(t,"id","container"),A(t,"class","fixed top-0 left-0 h-full w-screen bg-gray-300"),A(o,"class","fixed top-0 left-0 pointer-events-none"),A(o,"width",e[0]),A(o,"height",e[1]),A(r,"class","bg-cyan-200 px-4 py-2 rounded-lg mx-2"),A(m,"class","bg-cyan-200 px-4 py-2 rounded-lg mx-2"),A(s,"class","fixed top-0 left-0 w-screen p-4 bg-white shadow-lg")},m(c,y){G(c,t,y);for(let h=0;h<g.length;h+=1)g[h].m(t,null);G(c,n,y),G(c,o,y),e[16](o),G(c,l,y),G(c,s,y),Z(s,r),Z(r,M),Z(s,D),Z(s,m),Z(m,v),d||(S=[H(et,"resize",e[5]),H(t,"click",Ee(e[15])),H(t,"dblclick",Ee(e[4])),H(r,"click",e[17])],d=!0)},p(c,[y]){if(y&8){N=c[3];let h;for(h=0;h<N.length;h+=1){const _=ze(c,N,h);g[h]?g[h].p(_,y):(g[h]=He(_),g[h].c(),g[h].m(t,null))}for(;h<g.length;h+=1)g[h].d(1);g.length=N.length}y&1&&A(o,"width",c[0]),y&2&&A(o,"height",c[1])},i:ve,o:ve,d(c){c&&C(t),qe(g,c),c&&C(n),c&&C(o),e[16](null),c&&C(l),c&&C(s),d=!1,pe(S)}}}function rt({imageURL:e,content:t,id:n,position:o,connections:l}){return{imageURL:e,content:t,id:n,position:o,connections:l}}function it(e){return e.map(rt)}function st(e,t,n){let o,l,s=null;Je(()=>{n(0,o=window.innerWidth),n(1,l=window.innerHeight)});let r=[];function M(i){n(3,r=[...r,{position:{x:i.pageX,y:i.pageY},connections:[],id:crypto.randomUUID(),content:"My conspiracy note"}])}const D=()=>{n(0,o=window.innerWidth),n(1,l=window.innerHeight)},m=(i,u,f,p)=>{(p.key=="Escape"||p.key=="Esc")&&n(3,u[f].editable=!1,r)};function v(i,u,f){ue[i?"unshift":"push"](()=>{u[f].textarea=i,n(3,r)})}const d=(i,u,f)=>n(3,u[f].editable=!1,r);function S(i,u){i[u].content=this.value,n(3,r)}function N(i,u,f){ue[i?"unshift":"push"](()=>{u[f].self=i,n(3,r)})}const g=(i,u,f)=>{n(3,u[f].editable=!i.editable,r),Se().then(()=>{var p;return(p=i.textarea)==null?void 0:p.focus()})},c=(i,u,f)=>{const p=r.filter(E=>E!==i).filter(E=>E.selected);if(p.length!==0){if(p[0].connections.some(E=>E==i.id))return;n(3,r[r.indexOf(p[0])].selected=!1,r),n(3,u[f].connections=[...i.connections,p[0].id],r),n(3,r);return}n(3,u[f].selected=!i.selected,r)},y=(i,u,f,p)=>{if(!p||!p.detail)return;const{offsetX:E,offsetY:L}=p.detail;n(3,u[f].position.x=E,r),n(3,u[f].position.y=L,r)},h=(i,u,f)=>Se().then(()=>{n(3,u[f].selected=!1,r)}),_=()=>{n(3,r=r.map(i=>(i.selected=!1,i)))};function k(i){ue[i?"unshift":"push"](()=>{s=i,n(2,s)})}const R=()=>alert(JSON.stringify(it(r)));return e.$$.update=()=>{if(e.$$.dirty&15&&o&&l&&r.length>0&&s&&s.getContext("2d")){const i=s.getContext("2d");i.clearRect(0,0,o,l),r.forEach(u=>u.connections.forEach(f=>{var j,P,B,ee;const p=r.filter(W=>W.id==f);if(p.length===0)return;const E=p[0];i.strokeStyle="rgba(235, 64, 52, 0.3)",i.lineWidth=4,i.beginPath();const L=u.position.x+(((j=u.self)==null?void 0:j.clientWidth)||0)/2,x=u.position.y+(((P=u.self)==null?void 0:P.clientHeight)||0)/8,$=E.position.x+(((B=E.self)==null?void 0:B.clientWidth)||0)/2,Q=E.position.y+(((ee=E.self)==null?void 0:ee.clientHeight)||0)/8;i.moveTo(L,x),i.lineTo($,Q),i.stroke(),i.strokeStyle="rgba(0, 0, 0, 0)",i.fillStyle="#ebde34",i.beginPath(),i.arc(L,x,7,0,2*Math.PI),i.fill(),i.beginPath(),i.arc($,Q,7,0,2*Math.PI),i.fill()}))}},[o,l,s,r,M,D,m,v,d,S,N,g,c,y,h,_,k,R]}class at extends Oe{constructor(t){super(),We(this,t,st,ot,Ye,{})}}export{at as default};
