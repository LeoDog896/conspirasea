import{S as We,i as Be,s as Xe,e as Q,k as He,c as j,a as Z,m as ze,d as M,b as D,g as V,J as Te,K as z,L as qe,M as Pe,N as de,O as be,n as _e,P as Ye,w as Oe,Q as Ue,R as ae,E as Ie,t as Je,h as Ve,j as Fe,T as we}from"../chunks/index-4515c105.js";function Ke(e,t,n,o){var i,s=(i=o)==null||typeof i=="number"||typeof i=="boolean"?o:n(o),f=t.get(s);return f===void 0&&(f=e.call(this,o),t.set(s,f)),f}function Ge(e,t,n){var o=Array.prototype.slice.call(arguments,3),i=n(o),s=t.get(i);return s===void 0&&(s=e.apply(this,o),t.set(i,s)),s}function Qe(e,t){return function(n,o,i,s,f){return i.bind(o,n,s,f)}(e,this,e.length===1?Ke:Ge,t.cache.create(),t.serializer)}const je=JSON.stringify;function re(){this.cache=Object.create(null)}re.prototype.has=function(e){return e in this.cache},re.prototype.get=function(e){return this.cache[e]},re.prototype.set=function(e,t){this.cache[e]=t};var Ze={create:function(){return new re}};const xe=(e,t={})=>{var fe,ge;let{bounds:n,axis:o="both",gpuAcceleration:i=!0,applyUserSelectHack:s=!0,disabled:f=!1,ignoreMultitouch:r=!1,grid:a,position:g,cancel:d,handle:u,defaultClass:v="neodrag",defaultClassDragging:T="neodrag-dragging",defaultClassDragged:R="neodrag-dragged",defaultPosition:F={x:0,y:0},onDragStart:K,onDrag:y,onDragEnd:k}=t;const c=new Promise(requestAnimationFrame);let h,b,m=!1,w=0,C=0,L=0,W=0,I=0,G=0,{x,y:$}=g?{x:(fe=g==null?void 0:g.x)!=null?fe:0,y:(ge=g==null?void 0:g.y)!=null?ge:0}:F;ce(x,$,e,i);let Y,O,ie,U,ue="",Le=!!g;const se=document.body.style,B=e.classList,le=(l,A)=>{const N={offsetX:w,offsetY:C,domRect:e.getBoundingClientRect()};e.dispatchEvent(new CustomEvent(l,{detail:N})),A==null||A(N)},J=addEventListener;J("touchstart",ee,!1),J("touchend",te,!1),J("touchmove",ne,!1),J("mousedown",ee,!1),J("mouseup",te,!1),J("mousemove",ne,!1),e.style.touchAction="none";const he=()=>{let l=e.offsetWidth/O.width;return isNaN(l)&&(l=1),l};function ee(l){if(f||r&&l.type==="touchstart"&&l.touches.length>1)return;if(B.add(v),ie=function(p,E){if(!p)return E;if(p instanceof HTMLElement)return p;const _=E.querySelector(p);if(_===null)throw new Error("Selector passed for `handle` option should be child of the element on which the action is applied");return _}(u,e),U=function(p,E){if(!p)return;if(p instanceof HTMLElement)return p;const _=E.querySelector(p);if(_===null)throw new Error("Selector passed for `cancel` option should be child of the element on which the action is applied");return _}(d,e),h=/(both|x)/.test(o),b=/(both|y)/.test(o),n!==void 0&&(Y=function(p,E){if(p instanceof HTMLElement)return p.getBoundingClientRect();if(typeof p=="object"){const{top:X=0,left:q=0,right:P=0,bottom:oe=0}=p;return{top:X,right:window.innerWidth-P,bottom:window.innerHeight-oe,left:q}}if(p==="parent")return E.parentNode.getBoundingClientRect();const _=document.querySelector(p);if(_===null)throw new Error("The selector provided for bound doesn't exists in the document.");return _.getBoundingClientRect()}(n,e)),O=e.getBoundingClientRect(),Ee(u)&&Ee(d)&&u===d)throw new Error("`handle` selector can't be same as `cancel` selector");if(U!=null&&U.contains(ie))throw new Error("Element being dragged can't be a child of the element on which `cancel` is applied");if(ie.contains(l.target)&&!(U!=null&&U.contains(l.target))&&(m=!0),!m)return;s&&(ue=se.userSelect,se.userSelect="none"),le("neodrag:start",K);const{clientX:A,clientY:N}=ye(l)?l.touches[0]:l,S=he();h&&(L=A-x/S),b&&(W=N-$/S),Y&&(I=A-O.left,G=N-O.top)}function te(){m&&(B.remove(T),B.add(R),s&&(se.userSelect=ue),le("neodrag:end",k),h&&(L=w),h&&(W=C),m=!1)}function ne(l){if(!m)return;B.add(T),l.preventDefault(),O=e.getBoundingClientRect();const{clientX:A,clientY:N}=ye(l)?l.touches[0]:l;let S=A,p=N;const E=he();if(Y){const _={left:Y.left+I,top:Y.top+G,right:Y.right+I-O.width,bottom:Y.bottom+G-O.height};S=ke(S,_.left,_.right),p=ke(p,_.top,_.bottom)}if(Array.isArray(a)){let[_,X]=a;if(isNaN(+_)||_<0)throw new Error("1st argument of `grid` must be a valid positive number");if(isNaN(+X)||X<0)throw new Error("2nd argument of `grid` must be a valid positive number");let q=S-L,P=p-W;[q,P]=$e([Math.floor(_/E),Math.floor(X/E)],q,P),S=L+q,p=W+P}h&&(w=(S-L)*E),b&&(C=(p-W)*E),x=w,$=C,le("neodrag",y),c.then(()=>ce(w,C,e,i))}return{destroy:()=>{const l=removeEventListener;l("touchstart",ee,!1),l("touchend",te,!1),l("touchmove",ne,!1),l("mousedown",ee,!1),l("mouseup",te,!1),l("mousemove",ne,!1)},update:l=>{var N,S,p,E,_,X,q,P,oe,pe,me;o=l.axis||"both",f=(N=l.disabled)!=null?N:!1,r=(S=l.ignoreMultitouch)!=null?S:!1,u=l.handle,n=l.bounds,d=l.cancel,s=(p=l.applyUserSelectHack)!=null?p:!0,a=l.grid,i=(E=l.gpuAcceleration)!=null?E:!0;const A=B.contains(R);B.remove(v,R),v=(_=l.defaultClass)!=null?_:"neodrag",T=(X=l.defaultClassDragging)!=null?X:"neodrag-dragging",R=(q=l.defaultClassDragged)!=null?q:"neodrag-dragged",B.add(v),A&&B.add(R),Le&&(x=w=(oe=(P=l.position)==null?void 0:P.x)!=null?oe:w,$=C=(me=(pe=l.position)==null?void 0:pe.y)!=null?me:C,c.then(()=>ce(w,C,e,i)))}}},ye=e=>{var t;return!!((t=e.touches)!=null&&t.length)},ke=(e,t,n)=>Math.min(Math.max(e,t),n),Ee=e=>typeof e=="string";var Ae,Ne,Re;const $e=(ve=([e,t],n,o)=>{const i=(s,f)=>Math.round(s/f)*f;return[i(n,e),i(o,t)]},Ce=(Ae=H==null?void 0:H.cache)!=null?Ae:Ze,Se=(Ne=H==null?void 0:H.serializer)!=null?Ne:je,((Re=H==null?void 0:H.strategy)!=null?Re:Qe)(ve,{cache:Ce,serializer:Se}));var ve,H,Ce,Se;function ce(e,t,n,o){n.style.transform=o?`translate3d(${+e}px, ${+t}px, 0)`:`translate(${+e}px, ${+t}px)`}const{window:et}=Ue;function De(e,t,n){const o=e.slice();return o[16]=t[n],o[17]=t,o[18]=n,o}function tt(e){let t,n=(e[16].content||"")+"",o;return{c(){t=Q("span"),o=Je(n)},l(i){t=j(i,"SPAN",{});var s=Z(t);o=Ve(s,n),s.forEach(M)},m(i,s){V(i,t,s),Te(t,o)},p(i,s){s&8&&n!==(n=(i[16].content||"")+"")&&Fe(o,n)},d(i){i&&M(t)}}}function nt(e){let t,n=e[17],o=e[18],i,s;function f(...u){return e[6](e[16],e[17],e[18],...u)}const r=()=>e[7](t,n,o),a=()=>e[7](null,n,o);function g(){return e[8](e[16],e[17],e[18])}function d(){e[9].call(t,e[17],e[18])}return{c(){t=Q("textarea"),this.h()},l(u){t=j(u,"TEXTAREA",{class:!0,placeholder:!0}),Z(t).forEach(M),this.h()},h(){D(t,"class","resize-none dark:bg-black bg-white"),D(t,"placeholder","Enter notes content...")},m(u,v){V(u,t,v),r(),we(t,e[16].content),i||(s=[z(t,"keydown",f),z(t,"blur",g),z(t,"input",d)],i=!0)},p(u,v){e=u,(n!==e[17]||o!==e[18])&&(a(),n=e[17],o=e[18],r()),v&8&&we(t,e[16].content)},d(u){u&&M(t),a(),i=!1,de(s)}}}function Me(e){let t,n,o,i=e[17],s=e[18],f,r,a;function g(y,k){return y[16].editable?nt:tt}let d=g(e),u=d(e);const v=()=>e[10](t,i,s),T=()=>e[10](null,i,s);function R(){return e[11](e[16],e[17],e[18])}function F(){return e[12](e[16],e[17],e[18])}function K(...y){return e[13](e[16],e[17],e[18],...y)}return{c(){t=Q("div"),u.c(),n=He(),this.h()},l(y){t=j(y,"DIV",{class:!0});var k=Z(t);u.l(k),n=ze(k),k.forEach(M),this.h()},h(){D(t,"class",o="transition-shadow fixed max-w-md z-0 p-6 shadow-lg rounded-md "+(e[16].selected?"bg-gray-200":"bg-white")+" dark:bg-black")},m(y,k){V(y,t,k),u.m(t,null),Te(t,n),v(),r||(a=[z(t,"dblclick",R),z(t,"click",F),qe(f=xe.call(null,t,{axis:"both",bounds:"#container",position:e[16].position,defaultClassDragging:"box-dragging"})),z(t,"neodrag",K)],r=!0)},p(y,k){e=y,d===(d=g(e))&&u?u.p(e,k):(u.d(1),u=d(e),u&&(u.c(),u.m(t,n))),k&8&&o!==(o="transition-shadow fixed max-w-md z-0 p-6 shadow-lg rounded-md "+(e[16].selected?"bg-gray-200":"bg-white")+" dark:bg-black")&&D(t,"class",o),(i!==e[17]||s!==e[18])&&(T(),i=e[17],s=e[18],v()),f&&Pe(f.update)&&k&8&&f.update.call(null,{axis:"both",bounds:"#container",position:e[16].position,defaultClassDragging:"box-dragging"})},d(y){y&&M(t),u.d(),T(),r=!1,de(a)}}}function ot(e){let t,n,o,i,s,f=e[3],r=[];for(let a=0;a<f.length;a+=1)r[a]=Me(De(e,f,a));return{c(){t=Q("div");for(let a=0;a<r.length;a+=1)r[a].c();n=He(),o=Q("canvas"),this.h()},l(a){t=j(a,"DIV",{id:!0,class:!0});var g=Z(t);for(let d=0;d<r.length;d+=1)r[d].l(g);g.forEach(M),n=ze(a),o=j(a,"CANVAS",{class:!0,width:!0,height:!0}),Z(o).forEach(M),this.h()},h(){D(t,"id","container"),D(t,"class","fixed top-0 left-0 h-screen w-screen bg-gray-300"),D(o,"class","fixed z-10 top-0 left-0 pointer-events-none"),D(o,"width",e[0]),D(o,"height",e[1])},m(a,g){V(a,t,g);for(let d=0;d<r.length;d+=1)r[d].m(t,null);V(a,n,g),V(a,o,g),e[15](o),i||(s=[z(et,"resize",e[5]),z(t,"click",be(e[14])),z(t,"dblclick",be(e[4]))],i=!0)},p(a,[g]){if(g&8){f=a[3];let d;for(d=0;d<f.length;d+=1){const u=De(a,f,d);r[d]?r[d].p(u,g):(r[d]=Me(u),r[d].c(),r[d].m(t,null))}for(;d<r.length;d+=1)r[d].d(1);r.length=f.length}g&1&&D(o,"width",a[0]),g&2&&D(o,"height",a[1])},i:_e,o:_e,d(a){a&&M(t),Ye(r,a),a&&M(n),a&&M(o),e[15](null),i=!1,de(s)}}}function rt(e,t,n){let o,i,s=null;Oe(()=>{n(0,o=window.innerWidth),n(1,i=window.innerHeight)});function f(c){n(3,r=[...r,{position:{x:c.pageX,y:c.pageY},connections:[],id:crypto.randomUUID(),content:"My conspiracy note"}])}let r=[];const a=()=>{n(0,o=window.innerWidth),n(1,i=window.innerHeight)},g=(c,h,b,m)=>{(m.key=="Escape"||m.key=="Esc")&&n(3,h[b].editable=!1,r)};function d(c,h,b){ae[c?"unshift":"push"](()=>{h[b].textarea=c,n(3,r)})}const u=(c,h,b)=>n(3,h[b].editable=!1,r);function v(c,h){c[h].content=this.value,n(3,r)}function T(c,h,b){ae[c?"unshift":"push"](()=>{h[b].self=c,n(3,r)})}const R=(c,h,b)=>{n(3,h[b].editable=!c.editable,r),Ie().then(()=>{var m;return(m=c.textarea)==null?void 0:m.focus()})},F=(c,h,b)=>{const m=r.filter(w=>w!==c).filter(w=>w.selected);if(m.length!==0){n(3,r[r.indexOf(m[0])].selected=!1,r),n(3,h[b].connections=[...c.connections,m[0].id],r),n(3,r);return}n(3,h[b].selected=!c.selected,r)},K=(c,h,b,m)=>{if(!m||!m.detail)return;const{offsetX:w,offsetY:C}=m.detail;n(3,h[b].position.x=w,r),n(3,h[b].position.y=C,r)},y=()=>{n(3,r=r.map(c=>(c.selected=!1,c)))};function k(c){ae[c?"unshift":"push"](()=>{s=c,n(2,s)})}return e.$$.update=()=>{if(e.$$.dirty&15&&r.length>0&&s&&s.getContext("2d")){const c=s.getContext("2d");c.strokeStyle="rgba(235, 64, 52, 0.3)",c.lineWidth=4,c.clearRect(0,0,o,i),r.forEach(h=>h.connections.forEach(b=>{var C,L,W,I;const m=r.filter(G=>G.id==b);if(m.length===0)return;const w=m[0];c.beginPath(),c.moveTo(h.position.x+(((C=h.self)==null?void 0:C.clientWidth)||0)/2,h.position.y+(((L=h.self)==null?void 0:L.clientHeight)||0)/8),c.lineTo(w.position.x+(((W=w.self)==null?void 0:W.clientWidth)||0)/2,w.position.y+(((I=w.self)==null?void 0:I.clientHeight)||0)/8),c.stroke()}))}},[o,i,s,r,f,a,g,d,u,v,T,R,F,K,y,k]}class st extends We{constructor(t){super(),Be(this,t,rt,ot,Xe,{})}}export{st as default};
