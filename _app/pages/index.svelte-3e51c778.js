import{S as Le,i as We,s as Ye,e as x,k as ze,c as $,a as ee,m as Pe,d as M,b as C,g as K,J as Te,K as z,L as Be,M as qe,N as de,O as be,n as _e,P as Ie,w as Oe,Q as Ue,R as ae,E as we,t as Je,h as Ve,j as Fe,T as ye}from"../chunks/index-4515c105.js";function Ke(e,t,n,o){var s,l=(s=o)==null||typeof s=="number"||typeof s=="boolean"?o:n(o),f=t.get(l);return f===void 0&&(f=e.call(this,o),t.set(l,f)),f}function Ge(e,t,n){var o=Array.prototype.slice.call(arguments,3),s=n(o),l=t.get(s);return l===void 0&&(l=e.apply(this,o),t.set(s,l)),l}function Qe(e,t){return function(n,o,s,l,f){return s.bind(o,n,l,f)}(e,this,e.length===1?Ke:Ge,t.cache.create(),t.serializer)}const je=JSON.stringify;function ie(){this.cache=Object.create(null)}ie.prototype.has=function(e){return e in this.cache},ie.prototype.get=function(e){return this.cache[e]},ie.prototype.set=function(e,t){this.cache[e]=t};var Ze={create:function(){return new ie}};const xe=(e,t={})=>{var fe,ge;let{bounds:n,axis:o="both",gpuAcceleration:s=!0,applyUserSelectHack:l=!0,disabled:f=!1,ignoreMultitouch:r=!1,grid:c,position:g,cancel:d,handle:u,defaultClass:v="neodrag",defaultClassDragging:X="neodrag-dragging",defaultClassDragged:P="neodrag-dragged",defaultPosition:G={x:0,y:0},onDragStart:Q,onDrag:j,onDragEnd:y}=t;const k=new Promise(requestAnimationFrame);let i,h,m=!1,p=0,_=0,D=0,L=0,J=0,V=0,{x:I,y:O}=g?{x:(fe=g==null?void 0:g.x)!=null?fe:0,y:(ge=g==null?void 0:g.y)!=null?ge:0}:G;ce(I,O,e,s);let A,N,Z,U,ue="",Xe=!!g;const se=document.body.style,W=e.classList,le=(a,R)=>{const H={offsetX:p,offsetY:_,domRect:e.getBoundingClientRect()};e.dispatchEvent(new CustomEvent(a,{detail:H})),R==null||R(H)},F=addEventListener;F("touchstart",te,!1),F("touchend",ne,!1),F("touchmove",oe,!1),F("mousedown",te,!1),F("mouseup",ne,!1),F("mousemove",oe,!1),e.style.touchAction="none";const he=()=>{let a=e.offsetWidth/N.width;return isNaN(a)&&(a=1),a};function te(a){if(f||r&&a.type==="touchstart"&&a.touches.length>1)return;if(W.add(v),Z=function(b,E){if(!b)return E;if(b instanceof HTMLElement)return b;const w=E.querySelector(b);if(w===null)throw new Error("Selector passed for `handle` option should be child of the element on which the action is applied");return w}(u,e),U=function(b,E){if(!b)return;if(b instanceof HTMLElement)return b;const w=E.querySelector(b);if(w===null)throw new Error("Selector passed for `cancel` option should be child of the element on which the action is applied");return w}(d,e),i=/(both|x)/.test(o),h=/(both|y)/.test(o),n!==void 0&&(A=function(b,E){if(b instanceof HTMLElement)return b.getBoundingClientRect();if(typeof b=="object"){const{top:Y=0,left:B=0,right:q=0,bottom:re=0}=b;return{top:Y,right:window.innerWidth-q,bottom:window.innerHeight-re,left:B}}if(b==="parent")return E.parentNode.getBoundingClientRect();const w=document.querySelector(b);if(w===null)throw new Error("The selector provided for bound doesn't exists in the document.");return w.getBoundingClientRect()}(n,e)),N=e.getBoundingClientRect(),ve(u)&&ve(d)&&u===d)throw new Error("`handle` selector can't be same as `cancel` selector");if(U!=null&&U.contains(Z))throw new Error("Element being dragged can't be a child of the element on which `cancel` is applied");if(Z.contains(a.target)&&!(U!=null&&U.contains(a.target))&&(m=!0),!m)return;l&&(ue=se.userSelect,se.userSelect="none"),le("neodrag:start",Q);const{clientX:R,clientY:H}=ke(a)?a.touches[0]:a,S=he();i&&(D=R-I/S),h&&(L=H-O/S),A&&(J=R-N.left,V=H-N.top)}function ne(){m&&(W.remove(X),W.add(P),l&&(se.userSelect=ue),le("neodrag:end",y),i&&(D=p),i&&(L=_),m=!1)}function oe(a){if(!m)return;W.add(X),a.preventDefault(),N=e.getBoundingClientRect();const{clientX:R,clientY:H}=ke(a)?a.touches[0]:a;let S=R,b=H;const E=he();if(A){const w={left:A.left+J,top:A.top+V,right:A.right+J-N.width,bottom:A.bottom+V-N.height};S=Ee(S,w.left,w.right),b=Ee(b,w.top,w.bottom)}if(Array.isArray(c)){let[w,Y]=c;if(isNaN(+w)||w<0)throw new Error("1st argument of `grid` must be a valid positive number");if(isNaN(+Y)||Y<0)throw new Error("2nd argument of `grid` must be a valid positive number");let B=S-D,q=b-L;[B,q]=$e([Math.floor(w/E),Math.floor(Y/E)],B,q),S=D+B,b=L+q}i&&(p=(S-D)*E),h&&(_=(b-L)*E),I=p,O=_,le("neodrag",j),k.then(()=>ce(p,_,e,s))}return{destroy:()=>{const a=removeEventListener;a("touchstart",te,!1),a("touchend",ne,!1),a("touchmove",oe,!1),a("mousedown",te,!1),a("mouseup",ne,!1),a("mousemove",oe,!1)},update:a=>{var H,S,b,E,w,Y,B,q,re,pe,me;o=a.axis||"both",f=(H=a.disabled)!=null?H:!1,r=(S=a.ignoreMultitouch)!=null?S:!1,u=a.handle,n=a.bounds,d=a.cancel,l=(b=a.applyUserSelectHack)!=null?b:!0,c=a.grid,s=(E=a.gpuAcceleration)!=null?E:!0;const R=W.contains(P);W.remove(v,P),v=(w=a.defaultClass)!=null?w:"neodrag",X=(Y=a.defaultClassDragging)!=null?Y:"neodrag-dragging",P=(B=a.defaultClassDragged)!=null?B:"neodrag-dragged",W.add(v),R&&W.add(P),Xe&&(I=p=(re=(q=a.position)==null?void 0:q.x)!=null?re:p,O=_=(me=(pe=a.position)==null?void 0:pe.y)!=null?me:_,k.then(()=>ce(p,_,e,s)))}}},ke=e=>{var t;return!!((t=e.touches)!=null&&t.length)},Ee=(e,t,n)=>Math.min(Math.max(e,t),n),ve=e=>typeof e=="string";var Ne,Re,He;const $e=(Se=([e,t],n,o)=>{const s=(l,f)=>Math.round(l/f)*f;return[s(n,e),s(o,t)]},Ce=(Ne=T==null?void 0:T.cache)!=null?Ne:Ze,Me=(Re=T==null?void 0:T.serializer)!=null?Re:je,((He=T==null?void 0:T.strategy)!=null?He:Qe)(Se,{cache:Ce,serializer:Me}));var Se,T,Ce,Me;function ce(e,t,n,o){n.style.transform=o?`translate3d(${+e}px, ${+t}px, 0)`:`translate(${+e}px, ${+t}px)`}const{window:et}=Ue;function De(e,t,n){const o=e.slice();return o[17]=t[n],o[18]=t,o[19]=n,o}function tt(e){let t,n=(e[17].content||"")+"",o;return{c(){t=x("span"),o=Je(n)},l(s){t=$(s,"SPAN",{});var l=ee(t);o=Ve(l,n),l.forEach(M)},m(s,l){K(s,t,l),Te(t,o)},p(s,l){l&8&&n!==(n=(s[17].content||"")+"")&&Fe(o,n)},d(s){s&&M(t)}}}function nt(e){let t,n=e[18],o=e[19],s,l;function f(...u){return e[6](e[17],e[18],e[19],...u)}const r=()=>e[7](t,n,o),c=()=>e[7](null,n,o);function g(){return e[8](e[17],e[18],e[19])}function d(){e[9].call(t,e[18],e[19])}return{c(){t=x("textarea"),this.h()},l(u){t=$(u,"TEXTAREA",{class:!0,placeholder:!0}),ee(t).forEach(M),this.h()},h(){C(t,"class","resize-none dark:bg-black bg-white"),C(t,"placeholder","Enter notes content...")},m(u,v){K(u,t,v),r(),ye(t,e[17].content),s||(l=[z(t,"keydown",f),z(t,"blur",g),z(t,"input",d)],s=!0)},p(u,v){e=u,(n!==e[18]||o!==e[19])&&(c(),n=e[18],o=e[19],r()),v&8&&ye(t,e[17].content)},d(u){u&&M(t),c(),s=!1,de(l)}}}function Ae(e){let t,n,o,s=e[18],l=e[19],f,r,c;function g(y,k){return y[17].editable?nt:tt}let d=g(e),u=d(e);const v=()=>e[10](t,s,l),X=()=>e[10](null,s,l);function P(){return e[11](e[17],e[18],e[19])}function G(){return e[12](e[17],e[18],e[19])}function Q(...y){return e[13](e[17],e[18],e[19],...y)}function j(){return e[14](e[17],e[18],e[19])}return{c(){t=x("div"),u.c(),n=ze(),this.h()},l(y){t=$(y,"DIV",{class:!0});var k=ee(t);u.l(k),n=Pe(k),k.forEach(M),this.h()},h(){C(t,"class",o="transition-shadow fixed max-w-md z-0 p-6 shadow-lg rounded-md "+(e[17].selected?"bg-gray-200":"bg-white")+" dark:bg-black")},m(y,k){K(y,t,k),u.m(t,null),Te(t,n),v(),r||(c=[z(t,"dblclick",P),z(t,"click",G),Be(f=xe.call(null,t,{axis:"both",bounds:"#container",position:e[17].position,defaultClassDragging:"box-dragging"})),z(t,"neodrag",Q),z(t,"neodrag:end",j)],r=!0)},p(y,k){e=y,d===(d=g(e))&&u?u.p(e,k):(u.d(1),u=d(e),u&&(u.c(),u.m(t,n))),k&8&&o!==(o="transition-shadow fixed max-w-md z-0 p-6 shadow-lg rounded-md "+(e[17].selected?"bg-gray-200":"bg-white")+" dark:bg-black")&&C(t,"class",o),(s!==e[18]||l!==e[19])&&(X(),s=e[18],l=e[19],v()),f&&qe(f.update)&&k&8&&f.update.call(null,{axis:"both",bounds:"#container",position:e[17].position,defaultClassDragging:"box-dragging"})},d(y){y&&M(t),u.d(),X(),r=!1,de(c)}}}function ot(e){let t,n,o,s,l,f=e[3],r=[];for(let c=0;c<f.length;c+=1)r[c]=Ae(De(e,f,c));return{c(){t=x("div");for(let c=0;c<r.length;c+=1)r[c].c();n=ze(),o=x("canvas"),this.h()},l(c){t=$(c,"DIV",{id:!0,class:!0});var g=ee(t);for(let d=0;d<r.length;d+=1)r[d].l(g);g.forEach(M),n=Pe(c),o=$(c,"CANVAS",{class:!0,width:!0,height:!0}),ee(o).forEach(M),this.h()},h(){C(t,"id","container"),C(t,"class","fixed top-0 left-0 h-full w-screen bg-gray-300"),C(o,"class","fixed z-10 top-0 left-0 pointer-events-none"),C(o,"width",e[0]),C(o,"height",e[1])},m(c,g){K(c,t,g);for(let d=0;d<r.length;d+=1)r[d].m(t,null);K(c,n,g),K(c,o,g),e[16](o),s||(l=[z(et,"resize",e[5]),z(t,"click",be(e[15])),z(t,"dblclick",be(e[4]))],s=!0)},p(c,[g]){if(g&8){f=c[3];let d;for(d=0;d<f.length;d+=1){const u=De(c,f,d);r[d]?r[d].p(u,g):(r[d]=Ae(u),r[d].c(),r[d].m(t,null))}for(;d<r.length;d+=1)r[d].d(1);r.length=f.length}g&1&&C(o,"width",c[0]),g&2&&C(o,"height",c[1])},i:_e,o:_e,d(c){c&&M(t),Ie(r,c),c&&M(n),c&&M(o),e[16](null),s=!1,de(l)}}}function rt(e,t,n){let o,s,l=null;Oe(()=>{n(0,o=window.innerWidth),n(1,s=window.innerHeight)});function f(i){n(3,r=[...r,{position:{x:i.pageX,y:i.pageY},connections:[],id:crypto.randomUUID(),content:"My conspiracy note"}])}let r=[];const c=()=>{n(0,o=window.innerWidth),n(1,s=window.innerHeight)},g=(i,h,m,p)=>{(p.key=="Escape"||p.key=="Esc")&&n(3,h[m].editable=!1,r)};function d(i,h,m){ae[i?"unshift":"push"](()=>{h[m].textarea=i,n(3,r)})}const u=(i,h,m)=>n(3,h[m].editable=!1,r);function v(i,h){i[h].content=this.value,n(3,r)}function X(i,h,m){ae[i?"unshift":"push"](()=>{h[m].self=i,n(3,r)})}const P=(i,h,m)=>{n(3,h[m].editable=!i.editable,r),we().then(()=>{var p;return(p=i.textarea)==null?void 0:p.focus()})},G=(i,h,m)=>{const p=r.filter(_=>_!==i).filter(_=>_.selected);if(p.length!==0){if(p[0].connections.some(_=>_==i.id))return;n(3,r[r.indexOf(p[0])].selected=!1,r),n(3,h[m].connections=[...i.connections,p[0].id],r),n(3,r);return}n(3,h[m].selected=!i.selected,r)},Q=(i,h,m,p)=>{if(!p||!p.detail)return;const{offsetX:_,offsetY:D}=p.detail;n(3,h[m].position.x=_,r),n(3,h[m].position.y=D,r)},j=(i,h,m)=>we().then(()=>{n(3,h[m].selected=!1,r)}),y=()=>{n(3,r=r.map(i=>(i.selected=!1,i)))};function k(i){ae[i?"unshift":"push"](()=>{l=i,n(2,l)})}return e.$$.update=()=>{if(e.$$.dirty&15&&o&&s&&r.length>0&&l&&l.getContext("2d")){const i=l.getContext("2d");i.clearRect(0,0,o,s),r.forEach(h=>h.connections.forEach(m=>{var I,O,A,N;const p=r.filter(Z=>Z.id==m);if(p.length===0)return;const _=p[0];i.strokeStyle="rgba(235, 64, 52, 0.3)",i.lineWidth=4,i.beginPath();const D=h.position.x+(((I=h.self)==null?void 0:I.clientWidth)||0)/2,L=h.position.y+(((O=h.self)==null?void 0:O.clientHeight)||0)/8,J=_.position.x+(((A=_.self)==null?void 0:A.clientWidth)||0)/2,V=_.position.y+(((N=_.self)==null?void 0:N.clientHeight)||0)/8;i.moveTo(D,L),i.lineTo(J,V),i.stroke(),i.strokeStyle="rgba(0, 0, 0, 0)",i.fillStyle="#ebde34",i.beginPath(),i.arc(D,L,7,0,2*Math.PI),i.fill(),i.beginPath(),i.arc(J,V,7,0,2*Math.PI),i.fill()}))}},[o,s,l,r,f,c,g,d,u,v,X,P,G,Q,j,y,k]}class st extends Le{constructor(t){super(),We(this,t,rt,ot,Ye,{})}}export{st as default};
