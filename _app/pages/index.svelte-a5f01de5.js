import{N as ee,S as Je,i as Fe,s as Ge,e as Y,t as ae,k as ie,c as W,a as $,h as le,d as C,m as se,b as A,g as q,M as U,O as B,E as et,P as tt,Q as Ae,q as pe,n as nt,o as we,p as ot,j as Ke,R as Qe,T as rt,H as it,G as ke,w as st,x as at,y as lt,U as Me,V as ct,B as ut,v as dt,W as ft,X as R,Y as _e,D as Be,Z as Oe}from"../chunks/index-bd78507f.js";import{d as ht,w as Ze}from"../chunks/index-438404a3.js";function pt(e,t,o,n){var i,s=(i=n)==null||typeof i=="number"||typeof i=="boolean"?n:o(n),u=t.get(s);return u===void 0&&(u=e.call(this,n),t.set(s,u)),u}function gt(e,t,o){var n=Array.prototype.slice.call(arguments,3),i=o(n),s=t.get(i);return s===void 0&&(s=e.apply(this,n),t.set(i,s)),s}function mt(e,t){return function(o,n,i,s,u){return i.bind(n,o,s,u)}(e,this,e.length===1?pt:gt,t.cache.create(),t.serializer)}const bt=JSON.stringify;function ge(){this.cache=Object.create(null)}ge.prototype.has=function(e){return e in this.cache},ge.prototype.get=function(e){return this.cache[e]},ge.prototype.set=function(e,t){this.cache[e]=t};var _t={create:function(){return new ge}};const yt=(e,t={})=>{var Ce,De;let{bounds:o,axis:n="both",gpuAcceleration:i=!0,applyUserSelectHack:s=!0,disabled:u=!1,ignoreMultitouch:g=!1,grid:d,position:c,cancel:l,handle:r,defaultClass:p="neodrag",defaultClassDragging:h="neodrag-dragging",defaultClassDragged:w="neodrag-dragged",defaultPosition:D={x:0,y:0},onDragStart:O,onDrag:E,onDragEnd:m}=t;const k=new Promise(requestAnimationFrame);let z,a,b=!1,_=0,y=0,T=0,P=0,te=0,ne=0,{x:j,y:x}=c?{x:(Ce=c==null?void 0:c.x)!=null?Ce:0,y:(De=c==null?void 0:c.y)!=null?De:0}:D;ye(j,x,e,i);let V,X,oe,J,Ee="",xe=!!c;const me=document.body.style,G=e.classList,be=(f,I)=>{const L={offsetX:_,offsetY:y,domRect:e.getBoundingClientRect()};e.dispatchEvent(new CustomEvent(f,{detail:L})),I==null||I(L)},re=addEventListener;re("touchstart",ce,!1),re("touchend",ue,!1),re("touchmove",de,!1),re("mousedown",ce,!1),re("mouseup",ue,!1),re("mousemove",de,!1),e.style.touchAction="none";const Se=()=>{let f=e.offsetWidth/X.width;return isNaN(f)&&(f=1),f};function ce(f){if(u||g&&f.type==="touchstart"&&f.touches.length>1)return;if(G.add(p),oe=function(v,M){if(!v)return M;if(v instanceof HTMLElement)return v;const S=M.querySelector(v);if(S===null)throw new Error("Selector passed for `handle` option should be child of the element on which the action is applied");return S}(r,e),J=function(v,M){if(!v)return;if(v instanceof HTMLElement)return v;const S=M.querySelector(v);if(S===null)throw new Error("Selector passed for `cancel` option should be child of the element on which the action is applied");return S}(l,e),z=/(both|x)/.test(n),a=/(both|y)/.test(n),o!==void 0&&(V=function(v,M){if(v instanceof HTMLElement)return v.getBoundingClientRect();if(typeof v=="object"){const{top:K=0,left:Q=0,right:Z=0,bottom:fe=0}=v;return{top:K,right:window.innerWidth-Z,bottom:window.innerHeight-fe,left:Q}}if(v==="parent")return M.parentNode.getBoundingClientRect();const S=document.querySelector(v);if(S===null)throw new Error("The selector provided for bound doesn't exists in the document.");return S.getBoundingClientRect()}(o,e)),X=e.getBoundingClientRect(),Ue(r)&&Ue(l)&&r===l)throw new Error("`handle` selector can't be same as `cancel` selector");if(J!=null&&J.contains(oe))throw new Error("Element being dragged can't be a child of the element on which `cancel` is applied");if(oe.contains(f.target)&&!(J!=null&&J.contains(f.target))&&(b=!0),!b)return;s&&(Ee=me.userSelect,me.userSelect="none"),be("neodrag:start",O);const{clientX:I,clientY:L}=He(f)?f.touches[0]:f,H=Se();z&&(T=I-j/H),a&&(P=L-x/H),V&&(te=I-X.left,ne=L-X.top)}function ue(){b&&(G.remove(h),G.add(w),s&&(me.userSelect=Ee),be("neodrag:end",m),z&&(T=_),z&&(P=y),b=!1)}function de(f){if(!b)return;G.add(h),f.preventDefault(),X=e.getBoundingClientRect();const{clientX:I,clientY:L}=He(f)?f.touches[0]:f;let H=I,v=L;const M=Se();if(V){const S={left:V.left+te,top:V.top+ne,right:V.right+te-X.width,bottom:V.bottom+ne-X.height};H=Re(H,S.left,S.right),v=Re(v,S.top,S.bottom)}if(Array.isArray(d)){let[S,K]=d;if(isNaN(+S)||S<0)throw new Error("1st argument of `grid` must be a valid positive number");if(isNaN(+K)||K<0)throw new Error("2nd argument of `grid` must be a valid positive number");let Q=H-T,Z=v-P;[Q,Z]=vt([Math.floor(S/M),Math.floor(K/M)],Q,Z),H=T+Q,v=P+Z}z&&(_=(H-T)*M),a&&(y=(v-P)*M),j=_,x=y,be("neodrag",E),k.then(()=>ye(_,y,e,i))}return{destroy:()=>{const f=removeEventListener;f("touchstart",ce,!1),f("touchend",ue,!1),f("touchmove",de,!1),f("mousedown",ce,!1),f("mouseup",ue,!1),f("mousemove",de,!1)},update:f=>{var L,H,v,M,S,K,Q,Z,fe,Te,Ne;n=f.axis||"both",u=(L=f.disabled)!=null?L:!1,g=(H=f.ignoreMultitouch)!=null?H:!1,r=f.handle,o=f.bounds,l=f.cancel,s=(v=f.applyUserSelectHack)!=null?v:!0,d=f.grid,i=(M=f.gpuAcceleration)!=null?M:!0;const I=G.contains(w);G.remove(p,w),p=(S=f.defaultClass)!=null?S:"neodrag",h=(K=f.defaultClassDragging)!=null?K:"neodrag-dragging",w=(Q=f.defaultClassDragged)!=null?Q:"neodrag-dragged",G.add(p),I&&G.add(w),xe&&(j=_=(fe=(Z=f.position)==null?void 0:Z.x)!=null?fe:_,x=y=(Ne=(Te=f.position)==null?void 0:Te.y)!=null?Ne:y,k.then(()=>ye(_,y,e,i)))}}},He=e=>{var t;return!!((t=e.touches)!=null&&t.length)},Re=(e,t,o)=>Math.min(Math.max(e,t),o),Ue=e=>typeof e=="string";var We,$e,qe;const vt=(ze=([e,t],o,n)=>{const i=(s,u)=>Math.round(s/u)*u;return[i(o,e),i(n,t)]},Pe=(We=F==null?void 0:F.cache)!=null?We:_t,Ve=($e=F==null?void 0:F.serializer)!=null?$e:bt,((qe=F==null?void 0:F.strategy)!=null?qe:mt)(ze,{cache:Pe,serializer:Ve}));var ze,F,Pe,Ve;function ye(e,t,o,n){o.style.transform=n?`translate3d(${+e}px, ${+t}px, 0)`:`translate(${+e}px, ${+t}px)`}function wt(e){const t=e-1;return t*t*t+1}function Xe(e,{delay:t=0,duration:o=400,easing:n=wt,x:i=0,y:s=0,opacity:u=0}={}){const g=getComputedStyle(e),d=+g.opacity,c=g.transform==="none"?"":g.transform,l=d*(1-u);return{delay:t,duration:o,easing:n,css:(r,p)=>`
			transform: ${c} translate(${(1-r)*i}px, ${(1-r)*s}px);
			opacity: ${d-l*p}`}}function je(e,t,o,n){var i,s,u=!0,g="withOld"in o,d=(E,m)=>{if(i=m,g&&(s=E),u){let k=t(E,m);if(t.length<2)m(k);else return k}},c=ht(e,d,n),l=!Array.isArray(e),r=E=>{u=!1,l?e.set(E):E.forEach((m,k)=>{e[k].set(m)}),u=!0};g&&(o=o.withOld);var p=o.length>=(g?3:2),h=null;function w(E){if(h&&(h(),h=null),g)var m=o(E,s,r);else var m=o(E,r);p?typeof m=="function"&&(h=m):r(m)}var D=!1;function O(E){var m,k,z,a;if(D){a=E(ee(c)),i(a);return}var b=c.subscribe(_=>{D?m?k=!0:m=!0:z=_});a=E(z),D=!0,i(a),b(),D=!1,k&&(a=ee(c)),m&&w(a)}return{subscribe:c.subscribe,set(E){O(()=>E)},update:O}}function kt({imageURL:e,content:t,id:o,position:n,connections:i}){return{imageURL:e,content:t,id:o,position:n,connections:i}}function Et(e){return e.map(kt)}const he=Ze([{name:"Conspirasea",elements:[]}]),ve=Ze(0),N=je([he,ve],([e,t])=>e[t],e=>(he.set(ee(he).map((t,o)=>ee(ve)==o?e:t)),[ee(he),ee(ve)])),St=je(N,e=>e.elements,e=>({name:ee(N).name,elements:e}));function Ie(e){let t,o,n,i,s,u,g,d,c,l,r,p,h;return{c(){t=Y("div"),o=Y("button"),n=ae("Conspiraseas"),i=ie(),s=Y("button"),u=ae("Save"),g=ie(),d=Y("button"),c=ae("Load"),this.h()},l(w){t=W(w,"DIV",{class:!0});var D=$(t);o=W(D,"BUTTON",{class:!0});var O=$(o);n=le(O,"Conspiraseas"),O.forEach(C),i=se(D),s=W(D,"BUTTON",{class:!0});var E=$(s);u=le(E,"Save"),E.forEach(C),g=se(D),d=W(D,"BUTTON",{class:!0});var m=$(d);c=le(m,"Load"),m.forEach(C),D.forEach(C),this.h()},h(){A(o,"class","bg-cyan-200 px-4 py-2 rounded-lg mx-2 hover:bg-cyan-300 transition-all active:bg-cyan-400"),A(s,"class","bg-cyan-200 px-4 py-2 rounded-lg mx-2 hover:bg-cyan-300 transition-all active:bg-cyan-400"),A(d,"class","bg-cyan-200 px-4 py-2 rounded-lg mx-2 hover:bg-cyan-300 transition-all active:bg-cyan-400"),A(t,"class","fixed top-0 left-0 w-screen p-4 bg-white shadow-lg")},m(w,D){q(w,t,D),U(t,o),U(o,n),U(t,i),U(t,s),U(s,u),U(t,g),U(t,d),U(d,c),r=!0,p||(h=B(s,"click",e[2]),p=!0)},p:et,i(w){r||(tt(()=>{l||(l=Ae(t,Xe,{y:-150},!0)),l.run(1)}),r=!0)},o(w){l||(l=Ae(t,Xe,{y:-150},!1)),l.run(0),r=!1},d(w){w&&C(t),w&&l&&l.end(),p=!1,h()}}}function Ct(e){let t,o,n=e[0]?"Hide":"Show",i,s,u,g,d=e[0]&&Ie(e);return{c(){d&&d.c(),t=ie(),o=Y("button"),i=ae(n),this.h()},l(c){d&&d.l(c),t=se(c),o=W(c,"BUTTON",{class:!0});var l=$(o);i=le(l,n),l.forEach(C),this.h()},h(){A(o,"class","fixed top-0 right-0 m-4 px-4 py-2 rounded-lg mx-2 bg-cyan-200")},m(c,l){d&&d.m(c,l),q(c,t,l),q(c,o,l),U(o,i),s=!0,u||(g=B(o,"click",e[3]),u=!0)},p(c,[l]){c[0]?d?(d.p(c,l),l&1&&pe(d,1)):(d=Ie(c),d.c(),pe(d,1),d.m(t.parentNode,t)):d&&(nt(),we(d,1,1,()=>{d=null}),ot()),(!s||l&1)&&n!==(n=c[0]?"Hide":"Show")&&Ke(i,n)},i(c){s||(pe(d),s=!0)},o(c){we(d),s=!1},d(c){d&&d.d(c),c&&C(t),c&&C(o),u=!1,g()}}}function Dt(e,t,o){let n;Qe(e,St,g=>o(1,n=g));let i=!0;return[i,n,()=>alert(JSON.stringify(Et(n))),()=>o(0,i=!i)]}class Tt extends Je{constructor(t){super(),Fe(this,t,Dt,Ct,Ge,{})}}const{window:Nt}=ft;function Le(e,t,o){const n=e.slice();return n[18]=t[o],n[19]=t,n[20]=o,n}function At(e){let t,o=(e[18].content||"")+"",n;return{c(){t=Y("span"),n=ae(o)},l(i){t=W(i,"SPAN",{});var s=$(t);n=le(s,o),s.forEach(C)},m(i,s){q(i,t,s),U(t,n)},p(i,s){s&8&&o!==(o=(i[18].content||"")+"")&&Ke(n,o)},d(i){i&&C(t)}}}function Mt(e){let t,o=e[19],n=e[20],i,s;function u(...r){return e[7](e[18],e[19],e[20],...r)}const g=()=>e[8](t,o,n),d=()=>e[8](null,o,n);function c(){return e[9](e[18],e[19],e[20])}function l(){e[10].call(t,e[19],e[20])}return{c(){t=Y("textarea"),this.h()},l(r){t=W(r,"TEXTAREA",{class:!0,placeholder:!0}),$(t).forEach(C),this.h()},h(){A(t,"class","resize-none dark:bg-black bg-white"),A(t,"placeholder","Enter notes content...")},m(r,p){q(r,t,p),g(),Oe(t,e[18].content),i||(s=[B(t,"keydown",u),B(t,"blur",c),B(t,"input",l)],i=!0)},p(r,p){e=r,(o!==e[19]||n!==e[20])&&(d(),o=e[19],n=e[20],g()),p&8&&Oe(t,e[18].content)},d(r){r&&C(t),d(),i=!1,ke(s)}}}function Ye(e){let t,o,n,i=e[19],s=e[20],u,g,d;function c(m,k){return m[18].editable?Mt:At}let l=c(e),r=l(e);const p=()=>e[11](t,i,s),h=()=>e[11](null,i,s);function w(){return e[12](e[18],e[19],e[20])}function D(){return e[13](e[18],e[19],e[20])}function O(...m){return e[14](e[18],e[19],e[20],...m)}function E(){return e[15](e[18],e[19],e[20])}return{c(){t=Y("div"),r.c(),o=ie(),this.h()},l(m){t=W(m,"DIV",{class:!0});var k=$(t);r.l(k),o=se(k),k.forEach(C),this.h()},h(){A(t,"class",n="transition-shadow fixed max-w-md z-0 p-6 shadow-lg rounded-md "+(e[18].selected?"bg-gray-200":"bg-white")+" dark:bg-black")},m(m,k){q(m,t,k),r.m(t,null),U(t,o),p(),g||(d=[B(t,"dblclick",w),B(t,"click",D),rt(u=yt.call(null,t,{axis:"both",bounds:"#container",position:e[18].position,defaultClassDragging:"box-dragging"})),B(t,"neodrag",O),B(t,"neodrag:end",E)],g=!0)},p(m,k){e=m,l===(l=c(e))&&r?r.p(e,k):(r.d(1),r=l(e),r&&(r.c(),r.m(t,o))),k&8&&n!==(n="transition-shadow fixed max-w-md z-0 p-6 shadow-lg rounded-md "+(e[18].selected?"bg-gray-200":"bg-white")+" dark:bg-black")&&A(t,"class",n),(i!==e[19]||s!==e[20])&&(h(),i=e[19],s=e[20],p()),u&&it(u.update)&&k&8&&u.update.call(null,{axis:"both",bounds:"#container",position:e[18].position,defaultClassDragging:"box-dragging"})},d(m){m&&C(t),r.d(),h(),g=!1,ke(d)}}}function Bt(e){let t,o,n,i,s,u,g,d,c=e[3].elements,l=[];for(let r=0;r<c.length;r+=1)l[r]=Ye(Le(e,c,r));return s=new Tt({}),{c(){t=Y("div");for(let r=0;r<l.length;r+=1)l[r].c();o=ie(),n=Y("canvas"),i=ie(),st(s.$$.fragment),this.h()},l(r){t=W(r,"DIV",{id:!0,class:!0});var p=$(t);for(let h=0;h<l.length;h+=1)l[h].l(p);p.forEach(C),o=se(r),n=W(r,"CANVAS",{class:!0,width:!0,height:!0}),$(n).forEach(C),i=se(r),at(s.$$.fragment,r),this.h()},h(){A(t,"id","container"),A(t,"class","fixed top-0 left-0 h-full w-screen bg-gray-300"),A(n,"class","fixed top-0 left-0 pointer-events-none"),A(n,"width",e[0]),A(n,"height",e[1])},m(r,p){q(r,t,p);for(let h=0;h<l.length;h+=1)l[h].m(t,null);q(r,o,p),q(r,n,p),e[17](n),q(r,i,p),lt(s,r,p),u=!0,g||(d=[B(Nt,"resize",e[6]),B(t,"click",Me(e[16])),B(t,"dblclick",Me(e[4]))],g=!0)},p(r,[p]){if(p&8){c=r[3].elements;let h;for(h=0;h<c.length;h+=1){const w=Le(r,c,h);l[h]?l[h].p(w,p):(l[h]=Ye(w),l[h].c(),l[h].m(t,null))}for(;h<l.length;h+=1)l[h].d(1);l.length=c.length}(!u||p&1)&&A(n,"width",r[0]),(!u||p&2)&&A(n,"height",r[1])},i(r){u||(pe(s.$$.fragment,r),u=!0)},o(r){we(s.$$.fragment,r),u=!1},d(r){r&&C(t),ct(l,r),r&&C(o),r&&C(n),e[17](null),r&&C(i),ut(s,r),g=!1,ke(d)}}}function Ot(e,t,o){let n;Qe(e,N,a=>o(3,n=a));let i,s,u=null;dt(()=>{o(0,i=window.innerWidth),o(1,s=window.innerHeight)});function g(a){R(N,n.elements=[...n.elements,{position:{x:a.pageX,y:a.pageY},connections:[],id:crypto.randomUUID(),content:"My conspiracy note"}],n)}function d(){if(!u||!u.getContext("2d"))return;const a=u.getContext("2d");a.clearRect(0,0,i,s),n.elements.forEach(b=>b.connections.forEach(_=>{var x,V,X,oe;const y=n.elements.filter(J=>J.id==_);if(y.length===0)return;const T=y[0];a.strokeStyle="rgba(235, 64, 52, 0.3)",a.lineWidth=4,a.beginPath();const P=b.position.x+(((x=b.self)==null?void 0:x.clientWidth)||0)/2,te=b.position.y+(((V=b.self)==null?void 0:V.clientHeight)||0)/8,ne=T.position.x+(((X=T.self)==null?void 0:X.clientWidth)||0)/2,j=T.position.y+(((oe=T.self)==null?void 0:oe.clientHeight)||0)/8;a.moveTo(P,te),a.lineTo(ne,j),a.stroke(),a.strokeStyle="rgba(0, 0, 0, 0)",a.fillStyle="#ebde34",a.beginPath(),a.arc(P,te,7,0,2*Math.PI),a.fill(),a.beginPath(),a.arc(ne,j,7,0,2*Math.PI),a.fill()}))}const c=()=>{o(0,i=window.innerWidth),o(1,s=window.innerHeight),d()},l=(a,b,_,y)=>{(y.key=="Escape"||y.key=="Esc")&&R(N,b[_].editable=!1,n)};function r(a,b,_){_e[a?"unshift":"push"](()=>{b[_].textarea=a,N.set(n)})}const p=(a,b,_)=>R(N,b[_].editable=!1,n);function h(a,b){a[b].content=this.value,N.set(n)}function w(a,b,_){_e[a?"unshift":"push"](()=>{b[_].self=a,N.set(n)})}const D=(a,b,_)=>{R(N,b[_].editable=!a.editable,n),Be().then(()=>{var y;return(y=a.textarea)==null?void 0:y.focus()})},O=(a,b,_)=>{const y=n.elements.filter(T=>T!==a).filter(T=>T.selected);if(y.length!==0){if(y[0].connections.some(T=>T==a.id))return;R(N,n.elements[n.elements.indexOf(y[0])].selected=!1,n),R(N,b[_].connections=[...a.connections,y[0].id],n),N.set(n);return}R(N,b[_].selected=!a.selected,n)},E=(a,b,_,y)=>{if(!y||!y.detail)return;const{offsetX:T,offsetY:P}=y.detail;R(N,b[_].position.x=T,n),R(N,b[_].position.y=P,n)},m=(a,b,_)=>Be().then(()=>{R(N,b[_].selected=!1,n)}),k=()=>{R(N,n.elements=n.elements.map(a=>(a.selected=!1,a)),n)};function z(a){_e[a?"unshift":"push"](()=>{u=a,o(2,u)})}return e.$$.update=()=>{e.$$.dirty&15&&i&&s&&n.elements.length>0&&u&&u.getContext("2d")&&d()},[i,s,u,n,g,d,c,l,r,p,h,w,D,O,E,m,k,z]}class Ut extends Je{constructor(t){super(),Fe(this,t,Ot,Bt,Ge,{})}}export{Ut as default};
