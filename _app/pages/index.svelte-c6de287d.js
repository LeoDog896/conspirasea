import{S as qe,i as Ie,s as Ve,e as U,t as fe,k as ie,c as W,a as Y,h as he,d as k,m as re,b as N,g as P,J as F,K as M,E as Ge,L as Qe,M as Te,q as ue,n as je,o as be,p as Ze,j as Je,N as Fe,O as xe,P as et,Q as ye,w as tt,x as nt,y as ot,R as Ne,T as it,B as rt,v as lt,U as st,V as B,W as me,D as De,X as Me}from"../chunks/index-4094aff6.js";import{w as at}from"../chunks/index-dad390f5.js";function ct(e,t,i,n){var r,l=(r=n)==null||typeof r=="number"||typeof r=="boolean"?n:i(n),u=t.get(l);return u===void 0&&(u=e.call(this,n),t.set(l,u)),u}function ut(e,t,i){var n=Array.prototype.slice.call(arguments,3),r=i(n),l=t.get(r);return l===void 0&&(l=e.apply(this,n),t.set(r,l)),l}function dt(e,t){return function(i,n,r,l,u){return r.bind(n,i,l,u)}(e,this,e.length===1?ct:ut,t.cache.create(),t.serializer)}const ft=JSON.stringify;function de(){this.cache=Object.create(null)}de.prototype.has=function(e){return e in this.cache},de.prototype.get=function(e){return this.cache[e]},de.prototype.set=function(e,t){this.cache[e]=t};var ht={create:function(){return new de}};const gt=(e,t={})=>{var ke,Ee;let{bounds:i,axis:n="both",gpuAcceleration:r=!0,applyUserSelectHack:l=!0,disabled:u=!1,ignoreMultitouch:g=!1,grid:d,position:a,cancel:c,handle:o,defaultClass:h="neodrag",defaultClassDragging:p="neodrag-dragging",defaultClassDragged:S="neodrag-dragged",defaultPosition:ee={x:0,y:0},onDragStart:te,onDrag:ne,onDragEnd:C}=t;const T=new Promise(requestAnimationFrame);let s,m,b=!1,_=0,w=0,H=0,$=0,j=0,Z=0,{x:K,y:G}=a?{x:(ke=a==null?void 0:a.x)!=null?ke:0,y:(Ee=a==null?void 0:a.y)!=null?Ee:0}:ee;_e(K,G,e,r);let R,z,oe,Q,we="",Ke=!!a;const ge=document.body.style,q=e.classList,pe=(f,L)=>{const O={offsetX:_,offsetY:w,domRect:e.getBoundingClientRect()};e.dispatchEvent(new CustomEvent(f,{detail:O})),L==null||L(O)},x=addEventListener;x("touchstart",le,!1),x("touchend",se,!1),x("touchmove",ae,!1),x("mousedown",le,!1),x("mouseup",se,!1),x("mousemove",ae,!1),e.style.touchAction="none";const ve=()=>{let f=e.offsetWidth/z.width;return isNaN(f)&&(f=1),f};function le(f){if(u||g&&f.type==="touchstart"&&f.touches.length>1)return;if(q.add(h),oe=function(y,D){if(!y)return D;if(y instanceof HTMLElement)return y;const v=D.querySelector(y);if(v===null)throw new Error("Selector passed for `handle` option should be child of the element on which the action is applied");return v}(o,e),Q=function(y,D){if(!y)return;if(y instanceof HTMLElement)return y;const v=D.querySelector(y);if(v===null)throw new Error("Selector passed for `cancel` option should be child of the element on which the action is applied");return v}(c,e),s=/(both|x)/.test(n),m=/(both|y)/.test(n),i!==void 0&&(R=function(y,D){if(y instanceof HTMLElement)return y.getBoundingClientRect();if(typeof y=="object"){const{top:I=0,left:V=0,right:J=0,bottom:ce=0}=y;return{top:I,right:window.innerWidth-J,bottom:window.innerHeight-ce,left:V}}if(y==="parent")return D.parentNode.getBoundingClientRect();const v=document.querySelector(y);if(v===null)throw new Error("The selector provided for bound doesn't exists in the document.");return v.getBoundingClientRect()}(i,e)),z=e.getBoundingClientRect(),He(o)&&He(c)&&o===c)throw new Error("`handle` selector can't be same as `cancel` selector");if(Q!=null&&Q.contains(oe))throw new Error("Element being dragged can't be a child of the element on which `cancel` is applied");if(oe.contains(f.target)&&!(Q!=null&&Q.contains(f.target))&&(b=!0),!b)return;l&&(we=ge.userSelect,ge.userSelect="none"),pe("neodrag:start",te);const{clientX:L,clientY:O}=Ae(f)?f.touches[0]:f,A=ve();s&&(H=L-K/A),m&&($=O-G/A),R&&(j=L-z.left,Z=O-z.top)}function se(){b&&(q.remove(p),q.add(S),l&&(ge.userSelect=we),pe("neodrag:end",C),s&&(H=_),s&&($=w),b=!1)}function ae(f){if(!b)return;q.add(p),f.preventDefault(),z=e.getBoundingClientRect();const{clientX:L,clientY:O}=Ae(f)?f.touches[0]:f;let A=L,y=O;const D=ve();if(R){const v={left:R.left+j,top:R.top+Z,right:R.right+j-z.width,bottom:R.bottom+Z-z.height};A=Be(A,v.left,v.right),y=Be(y,v.top,v.bottom)}if(Array.isArray(d)){let[v,I]=d;if(isNaN(+v)||v<0)throw new Error("1st argument of `grid` must be a valid positive number");if(isNaN(+I)||I<0)throw new Error("2nd argument of `grid` must be a valid positive number");let V=A-H,J=y-$;[V,J]=pt([Math.floor(v/D),Math.floor(I/D)],V,J),A=H+V,y=$+J}s&&(_=(A-H)*D),m&&(w=(y-$)*D),K=_,G=w,pe("neodrag",ne),T.then(()=>_e(_,w,e,r))}return{destroy:()=>{const f=removeEventListener;f("touchstart",le,!1),f("touchend",se,!1),f("touchmove",ae,!1),f("mousedown",le,!1),f("mouseup",se,!1),f("mousemove",ae,!1)},update:f=>{var O,A,y,D,v,I,V,J,ce,Se,Ce;n=f.axis||"both",u=(O=f.disabled)!=null?O:!1,g=(A=f.ignoreMultitouch)!=null?A:!1,o=f.handle,i=f.bounds,c=f.cancel,l=(y=f.applyUserSelectHack)!=null?y:!0,d=f.grid,r=(D=f.gpuAcceleration)!=null?D:!0;const L=q.contains(S);q.remove(h,S),h=(v=f.defaultClass)!=null?v:"neodrag",p=(I=f.defaultClassDragging)!=null?I:"neodrag-dragging",S=(V=f.defaultClassDragged)!=null?V:"neodrag-dragged",q.add(h),L&&q.add(S),Ke&&(K=_=(ce=(J=f.position)==null?void 0:J.x)!=null?ce:_,G=w=(Ce=(Se=f.position)==null?void 0:Se.y)!=null?Ce:w,T.then(()=>_e(_,w,e,r)))}}},Ae=e=>{var t;return!!((t=e.touches)!=null&&t.length)},Be=(e,t,i)=>Math.min(Math.max(e,t),i),He=e=>typeof e=="string";var We,Ye,$e;const pt=(Re=([e,t],i,n)=>{const r=(l,u)=>Math.round(l/u)*u;return[r(i,e),r(n,t)]},ze=(We=X==null?void 0:X.cache)!=null?We:ht,Le=(Ye=X==null?void 0:X.serializer)!=null?Ye:ft,(($e=X==null?void 0:X.strategy)!=null?$e:dt)(Re,{cache:ze,serializer:Le}));var Re,X,ze,Le;function _e(e,t,i,n){i.style.transform=n?`translate3d(${+e}px, ${+t}px, 0)`:`translate(${+e}px, ${+t}px)`}function mt(e){const t=e-1;return t*t*t+1}function Oe(e,{delay:t=0,duration:i=400,easing:n=mt,x:r=0,y:l=0,opacity:u=0}={}){const g=getComputedStyle(e),d=+g.opacity,a=g.transform==="none"?"":g.transform,c=d*(1-u);return{delay:t,duration:i,easing:n,css:(o,h)=>`
			transform: ${a} translate(${(1-o)*r}px, ${(1-o)*l}px);
			opacity: ${d-c*h}`}}function _t({imageURL:e,content:t,id:i,position:n,connections:r}){return{imageURL:e,content:t,id:i,position:n,connections:r}}function bt(e){return e.map(_t)}const E=at([]);function Pe(e){let t,i,n,r,l,u,g,d,a,c;return{c(){t=U("div"),i=U("button"),n=fe("Save"),r=ie(),l=U("button"),u=fe("Load"),this.h()},l(o){t=W(o,"DIV",{class:!0});var h=Y(t);i=W(h,"BUTTON",{class:!0});var p=Y(i);n=he(p,"Save"),p.forEach(k),r=re(h),l=W(h,"BUTTON",{class:!0});var S=Y(l);u=he(S,"Load"),S.forEach(k),h.forEach(k),this.h()},h(){N(i,"class","bg-cyan-200 px-4 py-2 rounded-lg mx-2"),N(l,"class","bg-cyan-200 px-4 py-2 rounded-lg mx-2"),N(t,"class","fixed top-0 left-0 w-screen p-4 bg-white shadow-lg")},m(o,h){P(o,t,h),F(t,i),F(i,n),F(t,r),F(t,l),F(l,u),d=!0,a||(c=M(i,"click",e[2]),a=!0)},p:Ge,i(o){d||(Qe(()=>{g||(g=Te(t,Oe,{y:-150},!0)),g.run(1)}),d=!0)},o(o){g||(g=Te(t,Oe,{y:-150},!1)),g.run(0),d=!1},d(o){o&&k(t),o&&g&&g.end(),a=!1,c()}}}function yt(e){let t,i,n=e[0]?"Hide":"Show",r,l,u,g,d=e[0]&&Pe(e);return{c(){d&&d.c(),t=ie(),i=U("button"),r=fe(n),this.h()},l(a){d&&d.l(a),t=re(a),i=W(a,"BUTTON",{class:!0});var c=Y(i);r=he(c,n),c.forEach(k),this.h()},h(){N(i,"class","fixed top-0 right-0 m-4 px-4 py-2 rounded-lg mx-2 bg-cyan-200")},m(a,c){d&&d.m(a,c),P(a,t,c),P(a,i,c),F(i,r),l=!0,u||(g=M(i,"click",e[3]),u=!0)},p(a,[c]){a[0]?d?(d.p(a,c),c&1&&ue(d,1)):(d=Pe(a),d.c(),ue(d,1),d.m(t.parentNode,t)):d&&(je(),be(d,1,1,()=>{d=null}),Ze()),(!l||c&1)&&n!==(n=a[0]?"Hide":"Show")&&Je(r,n)},i(a){l||(ue(d),l=!0)},o(a){be(d),l=!1},d(a){d&&d.d(a),a&&k(t),a&&k(i),u=!1,g()}}}function wt(e,t,i){let n;Fe(e,E,g=>i(1,n=g));let r=!0;return[r,n,()=>alert(JSON.stringify(bt(n))),()=>i(0,r=!r)]}class vt extends qe{constructor(t){super(),Ie(this,t,wt,yt,Ve,{})}}const{window:kt}=st;function Xe(e,t,i){const n=e.slice();return n[17]=t[i],n[18]=t,n[19]=i,n}function Et(e){let t,i=(e[17].content||"")+"",n;return{c(){t=U("span"),n=fe(i)},l(r){t=W(r,"SPAN",{});var l=Y(t);n=he(l,i),l.forEach(k)},m(r,l){P(r,t,l),F(t,n)},p(r,l){l&8&&i!==(i=(r[17].content||"")+"")&&Je(n,i)},d(r){r&&k(t)}}}function St(e){let t,i=e[18],n=e[19],r,l;function u(...o){return e[6](e[17],e[18],e[19],...o)}const g=()=>e[7](t,i,n),d=()=>e[7](null,i,n);function a(){return e[8](e[17],e[18],e[19])}function c(){e[9].call(t,e[18],e[19])}return{c(){t=U("textarea"),this.h()},l(o){t=W(o,"TEXTAREA",{class:!0,placeholder:!0}),Y(t).forEach(k),this.h()},h(){N(t,"class","resize-none dark:bg-black bg-white"),N(t,"placeholder","Enter notes content...")},m(o,h){P(o,t,h),g(),Me(t,e[17].content),r||(l=[M(t,"keydown",u),M(t,"blur",a),M(t,"input",c)],r=!0)},p(o,h){e=o,(i!==e[18]||n!==e[19])&&(d(),i=e[18],n=e[19],g()),h&8&&Me(t,e[17].content)},d(o){o&&k(t),d(),r=!1,ye(l)}}}function Ue(e){let t,i,n,r=e[18],l=e[19],u,g,d;function a(C,T){return C[17].editable?St:Et}let c=a(e),o=c(e);const h=()=>e[10](t,r,l),p=()=>e[10](null,r,l);function S(){return e[11](e[17],e[18],e[19])}function ee(){return e[12](e[17],e[18],e[19])}function te(...C){return e[13](e[17],e[18],e[19],...C)}function ne(){return e[14](e[17],e[18],e[19])}return{c(){t=U("div"),o.c(),i=ie(),this.h()},l(C){t=W(C,"DIV",{class:!0});var T=Y(t);o.l(T),i=re(T),T.forEach(k),this.h()},h(){N(t,"class",n="transition-shadow fixed max-w-md z-0 p-6 shadow-lg rounded-md "+(e[17].selected?"bg-gray-200":"bg-white")+" dark:bg-black")},m(C,T){P(C,t,T),o.m(t,null),F(t,i),h(),g||(d=[M(t,"dblclick",S),M(t,"click",ee),xe(u=gt.call(null,t,{axis:"both",bounds:"#container",position:e[17].position,defaultClassDragging:"box-dragging"})),M(t,"neodrag",te),M(t,"neodrag:end",ne)],g=!0)},p(C,T){e=C,c===(c=a(e))&&o?o.p(e,T):(o.d(1),o=c(e),o&&(o.c(),o.m(t,i))),T&8&&n!==(n="transition-shadow fixed max-w-md z-0 p-6 shadow-lg rounded-md "+(e[17].selected?"bg-gray-200":"bg-white")+" dark:bg-black")&&N(t,"class",n),(r!==e[18]||l!==e[19])&&(p(),r=e[18],l=e[19],h()),u&&et(u.update)&&T&8&&u.update.call(null,{axis:"both",bounds:"#container",position:e[17].position,defaultClassDragging:"box-dragging"})},d(C){C&&k(t),o.d(),p(),g=!1,ye(d)}}}function Ct(e){let t,i,n,r,l,u,g,d,a=e[3],c=[];for(let o=0;o<a.length;o+=1)c[o]=Ue(Xe(e,a,o));return l=new vt({}),{c(){t=U("div");for(let o=0;o<c.length;o+=1)c[o].c();i=ie(),n=U("canvas"),r=ie(),tt(l.$$.fragment),this.h()},l(o){t=W(o,"DIV",{id:!0,class:!0});var h=Y(t);for(let p=0;p<c.length;p+=1)c[p].l(h);h.forEach(k),i=re(o),n=W(o,"CANVAS",{class:!0,width:!0,height:!0}),Y(n).forEach(k),r=re(o),nt(l.$$.fragment,o),this.h()},h(){N(t,"id","container"),N(t,"class","fixed top-0 left-0 h-full w-screen bg-gray-300"),N(n,"class","fixed top-0 left-0 pointer-events-none"),N(n,"width",e[0]),N(n,"height",e[1])},m(o,h){P(o,t,h);for(let p=0;p<c.length;p+=1)c[p].m(t,null);P(o,i,h),P(o,n,h),e[16](n),P(o,r,h),ot(l,o,h),u=!0,g||(d=[M(kt,"resize",e[5]),M(t,"click",Ne(e[15])),M(t,"dblclick",Ne(e[4]))],g=!0)},p(o,[h]){if(h&8){a=o[3];let p;for(p=0;p<a.length;p+=1){const S=Xe(o,a,p);c[p]?c[p].p(S,h):(c[p]=Ue(S),c[p].c(),c[p].m(t,null))}for(;p<c.length;p+=1)c[p].d(1);c.length=a.length}(!u||h&1)&&N(n,"width",o[0]),(!u||h&2)&&N(n,"height",o[1])},i(o){u||(ue(l.$$.fragment,o),u=!0)},o(o){be(l.$$.fragment,o),u=!1},d(o){o&&k(t),it(c,o),o&&k(i),o&&k(n),e[16](null),o&&k(r),rt(l,o),g=!1,ye(d)}}}function Tt(e,t,i){let n;Fe(e,E,s=>i(3,n=s));let r,l,u=null;lt(()=>{i(0,r=window.innerWidth),i(1,l=window.innerHeight)});function g(s){B(E,n=[...n,{position:{x:s.pageX,y:s.pageY},connections:[],id:crypto.randomUUID(),content:"My conspiracy note"}],n)}const d=()=>{i(0,r=window.innerWidth),i(1,l=window.innerHeight)},a=(s,m,b,_)=>{(_.key=="Escape"||_.key=="Esc")&&B(E,m[b].editable=!1,n)};function c(s,m,b){me[s?"unshift":"push"](()=>{m[b].textarea=s,E.set(n)})}const o=(s,m,b)=>B(E,m[b].editable=!1,n);function h(s,m){s[m].content=this.value,E.set(n)}function p(s,m,b){me[s?"unshift":"push"](()=>{m[b].self=s,E.set(n)})}const S=(s,m,b)=>{B(E,m[b].editable=!s.editable,n),De().then(()=>{var _;return(_=s.textarea)==null?void 0:_.focus()})},ee=(s,m,b)=>{const _=n.filter(w=>w!==s).filter(w=>w.selected);if(_.length!==0){if(_[0].connections.some(w=>w==s.id))return;B(E,n[n.indexOf(_[0])].selected=!1,n),B(E,m[b].connections=[...s.connections,_[0].id],n),E.set(n);return}B(E,m[b].selected=!s.selected,n)},te=(s,m,b,_)=>{if(!_||!_.detail)return;const{offsetX:w,offsetY:H}=_.detail;B(E,m[b].position.x=w,n),B(E,m[b].position.y=H,n)},ne=(s,m,b)=>De().then(()=>{B(E,m[b].selected=!1,n)}),C=()=>{B(E,n=n.map(s=>(s.selected=!1,s)),n)};function T(s){me[s?"unshift":"push"](()=>{u=s,i(2,u)})}return e.$$.update=()=>{if(e.$$.dirty&15&&r&&l&&n.length>0&&u&&u.getContext("2d")){const s=u.getContext("2d");s.clearRect(0,0,r,l),n.forEach(m=>m.connections.forEach(b=>{var K,G,R,z;const _=n.filter(oe=>oe.id==b);if(_.length===0)return;const w=_[0];s.strokeStyle="rgba(235, 64, 52, 0.3)",s.lineWidth=4,s.beginPath();const H=m.position.x+(((K=m.self)==null?void 0:K.clientWidth)||0)/2,$=m.position.y+(((G=m.self)==null?void 0:G.clientHeight)||0)/8,j=w.position.x+(((R=w.self)==null?void 0:R.clientWidth)||0)/2,Z=w.position.y+(((z=w.self)==null?void 0:z.clientHeight)||0)/8;s.moveTo(H,$),s.lineTo(j,Z),s.stroke(),s.strokeStyle="rgba(0, 0, 0, 0)",s.fillStyle="#ebde34",s.beginPath(),s.arc(H,$,7,0,2*Math.PI),s.fill(),s.beginPath(),s.arc(j,Z,7,0,2*Math.PI),s.fill()}))}},[r,l,u,n,g,d,a,c,o,h,p,S,ee,te,ne,C,T]}class Mt extends qe{constructor(t){super(),Ie(this,t,Tt,Ct,Ve,{})}}export{Mt as default};
